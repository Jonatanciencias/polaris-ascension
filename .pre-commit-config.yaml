# Pre-commit hooks configuration for Radeon RX 580 Energy-Efficient Computing Framework

repos:
  # Python formatting and linting
  - repo: https://github.com/psf/black
    rev: 23.12.1
    hooks:
      - id: black
        language_version: python3

  - repo: https://github.com/pycqa/isort
    rev: 5.13.2
    hooks:
      - id: isort
        args: ["--profile", "black"]

  - repo: https://github.com/pycqa/flake8
    rev: 7.0.0
    hooks:
      - id: flake8
        args: ["--max-line-length=88", "--extend-ignore=E203,W503"]

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.8.0
    hooks:
      - id: mypy
        additional_dependencies: [types-all]
        args: ["--ignore-missing-imports"]

  # General file checks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-yaml
      - id: check-added-large-files
      - id: check-merge-conflict
      - id: debug-statements
      - id: check-ast

  # LaTeX checks (for paper)
  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v4.0.0-alpha.8
    hooks:
      - id: prettier
        files: \.(md|yaml|yml)$
        exclude: docs/paper/

  # Custom hooks for this project
  - repo: local
    hooks:
      - id: check-license-headers
        name: Check license headers
        entry: python scripts/check_license_headers.py
        language: system
        files: \.py$
        pass_filenames: false

      - id: validate-setup
        name: Validate setup.py and pyproject.toml
        entry: python -c "import setuptools; setuptools.setup()"
        language: system
        files: (setup\.py|pyproject\.toml)$
        pass_filenames: false

# Configuration for tools
[tool:isort]
profile = "black"
multi_line_output = 3
line_length = 88
known_first_party = ["src"]
known_third_party = ["numpy", "scipy", "sklearn", "torch", "tensorflow"]

[tool:black]
line-length = 88
target-version = ['py38', 'py39', 'py310', 'py311', 'py312']
include = '\.pyi?$'
extend-exclude = '''
/(
  # directories
  \.eggs
  | \.git
  | \.hg
  | \.mypy_cache
  | \.tox
  | \.venv
  | build
  | dist
  | docs/paper
)/
'''

[tool:mypy]
python_version = "3.8"
warn_return_any = true
warn_unused_configs = true
disallow_untyped_defs = true
disallow_incomplete_defs = true
check_untyped_defs = true
disallow_untyped_decorators = true
no_implicit_optional = true
warn_redundant_casts = true
warn_unused_ignores = true
warn_no_return = true
warn_unreachable = true
strict_equality = true
ignore_missing_imports = true

[[tool:mypy.overrides]]
module = [
    "pyopencl.*",
    "cupy.*",
    "torch.*",
    "tensorflow.*",
]
ignore_missing_imports = true